

from app import app, db  # Import your Flask app

@pytest.fixture
def client():
    """Create a test client for the Flask app"""
    app.config['TESTING'] = True
    with app.test_client() as client:
        yield client


def test_homepage_loads(client):
    """Test that the homepage returns a 200 status code"""
    response = client.get('/')
    assert response.status_code == 200
    assert response.content_type == 'text/html; charset=utf-8'    
    # assert b'Welcome' in response.data  # Adjust to match your content
    

def test_edit_user(client):
    response = client.post("/user/1/edit", data={
        "first_name": "Flask",
        "last_name": "Dude",
    })
    assert response.status_code == 200

@pytest.fixture
def client():
    """Create a test client for the Flask app"""
    app.config['TESTING'] = True
    with app.test_client() as client:
        yield client


def test_signup(client):
    email = "test@eleven.com"
    response = client.post('/signup', data={
        "email": email,
        "password": "password123"
    }, follow_redirects=False)

    # Verify user was created
    from app import User
    user = User.query.filter_by(email=email).first()
    assert user is not None

    # CHECK THAT IT IS A REDIRECT
    assert response.status_code == 302
    # Check that the second request was to the index page.
    assert response.location == '/articles' or response.location.endswith('/articles')